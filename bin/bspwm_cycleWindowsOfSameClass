#! /bin/bash

currentWindow=""
function getCurrentWindowID {
	currentWindow=`bspc query -H | tail -n1 | cut -d " " -f 3`
}

windowClass=""
function getClassFromWindowID {
	windowClass=$(bspc query -T | grep -i $currentWindow | cut -d " " -f 2)
}

nextWindow=""
function findNextWindow {
	IN=$(bspc query -T | grep -i $windowClass | cut -d " " -f 4)

	returnNext=false
	for x in $IN
	do
		if [ $returnNext == true ]
		then
			nextWindow=$x
			return 
		fi

		if [ $x == $1 ]
		then
			returnNext=true
		fi
	done

	for x in $IN
	do
		nextWindow=$x
		return
	done
}

prevWindow=""
function findPrevWindow {
	IN=$(bspc query -T | grep -i $windowClass | cut -d " " -f 4)

	returnPrev=false

	array=($IN)
	for ((i = ${#array[@]} - 1 ;i >= 0 ;i--))
	do
		echo ${array[i]}
		if [ $returnPrev == true ]
		then
			prevWindow=${array[i]}
			return 
		fi

		if [ ${array[i]} == $1 ]
		then
			returnPrev=true
		fi
	done

	for ((i = ${#array[@]} - 1 ;i >= 0 ;i--))
	do
		prevWindow=${array[i]}
		return 
	done

}

function gatherInfo {
	getCurrentWindowID
	getClassFromWindowID
}

if [ $1 == "next" ]
then
	gatherInfo
	findNextWindow $currentWindow
	bspc window -f $nextWindow
elif [ $1 == "prev" ]
then
	gatherInfo
	findPrevWindow $currentWindow
	bspc window -f $prevWindow
else
	echo "wrong input"
fi




